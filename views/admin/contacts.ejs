<%- include('../partials/header', { 
    title: 'Gerenciar Mensagens',
    user: user
}) %>

<div class="admin-container">
    <h1>Painel de Administração - Mensagens de Contato</h1>
    
    <div class="admin-stats">
        <div class="stat-card">
            <h3>Total de Mensagens</h3>
            <p id="totalMessages">0</p>
        </div>
        <div class="stat-card">
            <h3>Não Lidas</h3>
            <p id="unreadCount">0</p>
        </div>
        <div class="stat-card">
            <h3>Em Análise</h3>
            <p id="inProgressCount">0</p>
        </div>
        <div class="stat-card">
            <h3>Resolvidas</h3>
            <p id="resolvedCount">0</p>
        </div>
    </div>

    <div class="kanban-board">
        <div class="kanban-column" data-status="unread">
            <h2>Não Lidas</h2>
            <div class="kanban-items" id="unread-column">
                <!-- Messages will be loaded here -->
            </div>
        </div>
        
        <div class="kanban-column" data-status="in-progress">
            <h2>Em Análise</h2>
            <div class="kanban-items" id="in-progress-column">
                <!-- Messages will be loaded here -->
            </div>
        </div>
        
        <div class="kanban-column" data-status="resolved">
            <h2>Resolvidas</h2>
            <div class="kanban-items" id="resolved-column">
                <!-- Messages will be loaded here -->
            </div>
        </div>
    </div>
</div>

<!-- Message Details Modal -->
<div id="messageModal" class="modal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2>Detalhes da Mensagem</h2>
        <div class="message-details">
            <div class="detail-row">
                <strong>De:</strong>
                <span id="detail-name"></span> 
                <span id="detail-email"></span>
            </div>
            <div class="detail-row">
                <strong>Data:</strong>
                <span id="detail-date"></span>
            </div>
            <div class="detail-row">
                <strong>Assunto:</strong>
                <span id="detail-subject"></span>
            </div>
            <div class="detail-row full-width">
                <strong>Mensagem:</strong>
                <p id="detail-message"></p>
            </div>
            <div class="modal-actions">
                <button id="markInProgress" class="btn btn-warning">Marcar como Em Análise</button>
                <button id="markResolved" class="btn btn-success">Marcar como Resolvido</button>
                <button id="deleteMessage" class="btn btn-danger">Excluir Mensagem</button>
            </div>
        </div>
    </div>
</div>

<%- include('../partials/footer') %>

<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.14.0/Sortable.min.js"></script>
<script src="/js/admin/contacts.js"></script>
